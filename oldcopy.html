<!DOCTYPE html>
<html>
  <head>
  <style>
  p {
		width:50%;
		}
  
  </style>
    <script>
		//Ralph Calachan and Key
      var apiKey = 'RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6';
	  var searcher;
	  var searchmatchid;
      document.addEventListener('DOMContentLoaded', bindButtons);
	  
	  function getMatchID(id, playerId){
		var req2 = new XMLHttpRequest();
		req2.open('GET', "https://na.api.pvp.net/api/lol/na/v2.2/matchlist/by-summoner/" + id + "?api_key=" +apiKey, true);
		req2.send(null);
		req2.addEventListener('load',function(){
		if(req2.status >= 200 && req2.status < 400){
			console.log("event2");
			var response2 = JSON.parse(req2.responseText);
			console.log(response2);
			document.getElementById('lane').textContent = response2.matches[0].lane;
			var champID = response2.matches[0].champion;
			var matchSearchID = response2.matches[0].matchId;
			getChampion(champID);
			getPlayerWin(playerId, matchSearchID);
		}
		else{
				  console.log("Error!!");
		}
		});
		console.log(searchmatchid);
	  }
	  
	  function getChampion(id){
		var req2 = new XMLHttpRequest();
		req2.open('GET', "https://global.api.pvp.net/api/lol/static-data/na/v1.2/champion/" + id + "?api_key=" +apiKey, true);
		req2.send(null);
		req2.addEventListener('load',function(){
		if(req2.status >= 200 && req2.status < 400){
			console.log("event3");
			var response2 = JSON.parse(req2.responseText);
			console.log(response2);
			document.getElementById('champ').textContent = response2.name + ", " + response2.title;
		}
		else{
				  console.log("Error!!");
		}
		});
		
	  
	  }
	  
	  //THIS FUNCTION RETRIVES Victory condition
	  function getPlayerWin(playerid, matchid){
		var req2 = new XMLHttpRequest();
		console.log("getplayeritems");
		req2.open('GET', "https://na.api.pvp.net/api/lol/na/v2.2/match/" + matchid + "?api_key=" +apiKey, true);
		req2.send(null);
		req2.addEventListener('load',function(){
		if(req2.status >= 200 && req2.status < 400){
			console.log("event3");
			var response2 = JSON.parse(req2.responseText);
			for(var i = 0; i < response2.participantIdentities.length; i++){
				console.log("search id is " + response2.participantIdentities[i].player.summonerId);
				if(response2.participantIdentities[i].player.summonerId == String(playerid))
				{
					console.log("playeridsearch");
					var partid = response2.participantIdentities[i].participantId;
					console.log("partid = " )
					break;
				}
				else{console.log("ERROR PLAYER NOT FOUND")};
			}
			for(var i = 0; i < response2.participants.length; i++){
				console.log("search id is " + response2.participants[i].participantId);
				if(response2.participants[i].participantId == String(partid)){
					console.log("found participant");
					if(response2.participants[i].stats.winner == true){
						document.getElementById('win').textContent = "Won";
					}
					else{
						document.getElementById('win').textContent = "Lost";
					}
				}
			}
		}
		else{
				  console.log("Error!!");
		}
		});
		
	  
	  }
	  
      function bindButtons(){
	  
        document.getElementById('urlSubmit').addEventListener('click', function(event){
          var req = new XMLHttpRequest();
		  if(document.getElementById('inputName').value != ''){
			  console.log("Name Found");
			  var inputName = document.getElementById('inputName').value;
			  console.log(inputName);
			  req.open('GET', "https://na.api.pvp.net/api/lol/na/v1.4/summoner/by-name/" +inputName + "?api_key=" + apiKey ,true);
			  req.send(null);
			  console.log("1");
			  req.addEventListener('load',function(){
			  if(req.status >= 200 && req.status < 400){
					console.log("2");
				  var response = JSON.parse(req.responseText);
				  console.log(response);
				  document.getElementById('sumid').textContent = response[Object.keys(response)[0]].id;
				  document.getElementById('sumlvl').textContent = response[Object.keys(response)[0]].summonerLevel;
				  searcher = response[Object.keys(response)[0]].id;
				  console.log(searcher);
				  getMatchID(searcher, response[Object.keys(response)[0]].id );
				
					
			}
			else{
				  console.log("Error!!");
			}
			  })
			  event.preventDefault();
			}
		})
		
	  }
    </script>
  </head>
  <body>
	<p>
    <strong><u>Riot Games API by Ralph Calachan (OSUID: Calachar)</u></strong>
</p>
<p>
    The League of Legends API is fairly simple at a first glance but provides a
    large amount of functions available to the developer. Each function helps
    return information that allows the use of more complicated functions. Here
    in this How-To guide I will go over the methods and how I would use them to
    create something more in depth.
</p>
<p>
    The methods I will go through will be separated into two groups, the League
    of Legends static data method and the simple information request methods. I
    separated them in accordance to how much information can be supplied.
</p>
<p>
    We will then use these methods to create a small application that will be
    able to take any Summoner Name and return relevant data through several GET
    calls such as ID, Last Match Champion, Last Match Lane, Last Match Result.
</p>
<p>
    <strong>Example Summoner Info used:</strong>
</p>
<p>
    <strong>Summoner Name: articunoisabeast</strong>
</p>
<p>
    <strong>Summoner ID: 23759612</strong>
</p>
<p>
    <strong>API KEY USED: </strong>
    <strong>RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6</strong>
</p>
<p>
    <u>League of Legends Static Data</u>
</p>
<p>
    League of Legends Static Data Method is used to obtain information from the
    current build of the game. This method will return necessary information
    about champions and items. This includes health, gold to buy and other
    statistics.
</p>
<p>
    Now let’s go over some of the simpler GET commands for objects found in
    League of Legends.
</p>
<p>
    <strong><u>/champion</u></strong>
</p>
<p>
    First is /champion
</p>
<p>
    /champion will return information about champion/characters in League of
    Legends.
</p>
<p>
    The default information returned is actually a list of Champions currently
    in the game. The list contains pertinent information for usage such as
    name, id, title and key. The key is the nonnumerical identifier used in the
    api, the id is the numerical identifier.
</p>
<p>
    For example,
</p>
<p>
    Sending through GET:
</p>
<p>
    https://global.api.pvp.net/api/lol/static-data/na/v1.2/champion?api_key=RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6
</p>
<p>
    returns data containing every single champion available.
</p>
<p>
    Now that is just the default capabilities of the method. The /champion
    method can also provide much more in-depth information about the champion
    such as attackrange, hp/hitpoints and armor. This is done by attaching one
    of the champData queries. So in the previous example we can append
    (?champdata=stats) to get those results.
</p>
<p>
    From:
    https://global.api.pvp.net/api/lol/static-data/na/v1.2/champion?champData=stats&amp;api_key=RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6
</p>
<br/>
<img src="http://imgur.com/LJd0tFo.png">
<p>
    As you can see this allows /champion to provide exact numbers on statistics
    that would not be necessary for casual users. The amount of information
    available is stagger but to go over each of the champData options would be
    prudent.
</p>
<p>
    All = all information that is contained below, not recommended due to the
    sheer size of returned data.
</p>
<p>
    Allytips = string data types given to players in game on how to play with
    this champion in the team.
</p>
<p>
    blurb = returns a string containing a short description of the champion
</p>
<p>
    enemytips = string data types given to players in game on how to fight this
    champion in the other team.
</p>
<p>
    Image = string containing the name of the full image, sprite and grouping
    of the default image for the champion, this includes width and height in
    pixels of the icon. For example the full sprite is returned as “Sona.png”
    and sprite returned as “Champion3.png”
</p>
<p>
    Info = a object named info that contains four abstract measurements of
    aspects of the hero. These are Defense, Magic, Difficulty and Attack.
</p>
<p>
    Lore = a string containing the lore behind the champion.
</p>
<p>
    Partype = the name of the resource the champion uses
</p>
<p>
    Passive = the name and description of the passive ability of the champion,
    including the icon name.
</p>
<p>
    Skins = returns an object named “skins” that contains several objects
    consisting of an id number of the skin, the number of the skin relative to
    the champion, and the string containing the name of the string.
</p>
<p>
    Spells = returns an object “spells” that contains objects for each spell
    the champion can use, these are large objects that include range of
    attacks, leveling tips, resources, ranks and other values. The object is
    constructed in a way to allow developers full access of each spell and its
    statistics and abilities.
</p>
<p>
    Tags = returns objects containing strings that are used to link several
    champions together such as “Tank” or “Support”
</p>
<p>
    The /champion method can be directly references with /champion/{id}. This
    allows the developer to obtain information on any SINGLE champion with that
    ID. This prevents the problem of the previously discussed of returning a
    list of all champions available.
</p>
<p>
    https://global.api.pvp.net/api/lol/static-data/na/v1.2/champion/12?api_key=RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6
</p>
<p>
    Simply returns,
</p>
<br/>
<p>
    /champion/{id} can return any information already listed under the
    /champion method.
</p>
<p>
    This is the code we will use later to retrieve the name and title of the
    champion played. The function does require a input id to be used but this
    will be more apparent when we put together our site.
</p>
<p>
    <strong>/item</strong>
</p>
<p>
    The /item method is the same as the champion method but allows the user to
    obtain information on purchasable objects in the game instead of champions.
    The method is very similar to /champion and thus I will go over it in a
    shortened manner.
</p>
<p>
    https://global.api.pvp.net/api/lol/static-data/na/v1.2/item?api_key=RGAPI-a510292f-352d-4f62-b7ec-e12be9af98f6
</p>
<p>
    returns an object containing every object in the game, including id, name,
    description and plaintext.
</p>
<br/>
<img src="http://imgur.com/ZHok0lB.png">
<p>
    You can see that it is very like how information is returned under the
    /champion method. The most important ones are as follows:
</p>
<p>
    ?itemListData/all = all information on the items
</p>
<p>
    /gold = the amount I costs, the amount it sells for, the base cost and if
    the item is in fact purchasable.
</p>
<p>
    /tags = the groups the item belong to such as “CriticalStrike” or
    “AttackSpeek”
</p>
<p>
    Exactly like, /champion/{id}, there is an /item/{id} that allows the
    developer to obtain information for any SINGLE item instead of a list.
</p>
<p>
    /champion and /item allow the developer to access the database of
    information available on the game, using these functions with functions to
    find summoners and matchs, we can create a way to show information from the
    game.
</p>
<p>
    <strong>Other League of Legend Static Data Methods</strong>
</p>
<p>
    /map = method to obtain object containing list of maps and their ids
</p>
<p>
    /mastery = method to obtain a list of mastery abilities in the game
</p>
<p>
    /master/{id} = method to obtain the information of a SINGLE mastery
</p>
<p>
    /rune = method to obtain the information on all ruins in the game
</p>
<p>
    /rune/{id} = method to obtain the information on a single rune
</p>
<p>
    /summoner-spell = method to obtain summoenr spell information
</p>
<p>
    /summoner-spell/{id} = method to obtain summoner spell information for a
    single spell
</p>
<p>
    /version = returns list of version numbers
</p>
<p>
    <strong>Non Static Data Methods</strong>
</p>
<p>
    Here we will be going over the necessary methods to customize and create
    the match information creator. Let us start with the easiest and most
    simple method, /summoner.
</p>
<p>
    /summoner
</p>
<p>
    Allows the user to gather information about summoners in the game.
    Summoners are the unique ids assigned to each player. In these examples my
    friend is “articunoisabeast”.
</p>
<p>
    There are two essential methods to using /summoner.
</p>
<p>
    /by-name/{summoner-name}, which lets you in put the string that is the name
    and it returns Summoner ID, Summoner String name, their level and their
    profile icon.
</p>
<p>
    /{summonerId}, which takes the id of the Summoner and returns the same
    information as by-name.
</p>
<p>
    For example inputing /summoner/by-name/articunoisabeast, returns:
</p>
<img src="http://imgur.com/XIa66nx.png">
<p>
    Utilizing this GET request, we can start to see how we would form a program
    to take a easily knowable piece of information (the summoner name) and gain
    more valuable or unknowable information (champion played and game won or
    lost).
</p>
<p>
    Using an asynchronous GET, we can first program a site to take a value from
    a box on the site, the program will then input that into a GET call and
    using the response, display the summonerId and summoner level.
</p>
<br/>
<img src="http://imgur.com/XuIEt3a.png">
<p>
    Here we can see that I assembled the GET response using the initial url,
    the inputName variable and the apiKey variable. The code then waits for the
    response and parses the response to javascript.
</p>
<p>
    <strong>ISSUE!</strong>
</p>
<p>
    A known issue is that the JSON returned has the name of the input as the
    object name. Because the name of the summoner input changes with each call,
    you cannot use a static property accessor like (.matches) used below.
    Therefore we use the Object.keys command to simply retrieve the first
    object and then use the universal id and summonerLevel properties to access
    them.
</p>
<p>
    <strong>/matchlist</strong>
</p>

<p>
    The next method we will use to create our little api application is
    /matchlist. /matchlist is used to retrieve a list of matches played by a
    summoner.
</p>
<p>
    The only method is /matchlist/by-summoner/{summonerId}, therefore we have
    to use the summoenr Id we found with /summoner to access the api
    automatically. The /matchlist returns an object with the property (matches)
    which itself contains several objects that contain the match id, lane of
    the champion, which champion, season and timestamp.
</p>
<p>
    Using the api GET call with summonerId for articunoisbeast we get the
    following response:
</p>
<br/>
<img src="http://imgur.com/Y8Cp0Ob.png">
<p>
    Now we want to get whether the summoner actiually own their last match, in
    order to do that we must look more indepth into the match. In order to do
    that we need the matchId of the latest match. Luckily the latest match is
    always at matches[0]. Therefore we can simply program the site to take the
    first match and return the unique matchId.
</p>
<br/>
<img src="http://imgur.com/M4E2VMM.png">
<p>
    Here you can see that the response is fairly simple, with
    response2.matches[0].lane always referring to the lane played in that
    match. The function also calls getChampion which will turn the champion
    variable into something understandable by the user, which is the champions
    name and title. This is the static data function we learned about above.
    Then, getPlayerWin is called to retrieve the actual result of the match.
</p>
<p>
    <strong>/match</strong>
</p>
<p>
    Finally, we will use the /match method to retrieve particular details of
    the last match played in order to get information on whether the player
    won. This method only has one way to be used.
</p>
<p>
    /match/{matchId}, which is why we needed to retrieve the matchId from
    /matchlist. When you call /match with the pertinent match ID, you receive a
    very large object full of information, we will go over the most important
    ones, stats and participants.
</p>
<br/>
<img src="http://imgur.com/5D5flZ9.png">
<p>
    First we need to find out which of the participants is actually the player
    we are searching for. In order to do this we pass the Summoner ID into the
    function. We can then utilize a for loop to search through the
    participantIdentities object, we check if any of the participants share a
    summoner ID with the one we passed to the function, if it does, that means
    we have found the player in the match.
</p>
<br/>
<img src="http://imgur.com/4qF0ZWr.png">
<p>
    Here we see the summonerId matches and we have found our friend
    articunoisabeast. Now you may ask why we did this, that is because
    information in the participant’s object DOES NOT actually refer to the
    summoner ID or summoner Name, instead it only references the participant
    ID. Therefore, this is a very necessary part of finding out the information
    of the match.
</p>
<p>
    Finally we can access the participants.stats.winner property of that
    particular match, which returns a Boolean on whether that participant was
    on the winning or losing side of the match. And thus, our little
    application is complete. The application is found below and can be played
    with or you can use the default test subject, “articunoisabeast” or any
    other League of Legends summoner Name.
</p>
<img src="http://imgur.com/JgAUFcK.png">
<br/>
<br/>
<strong>LEGUE OF LEGENDS SUMMONER LAST MATCH PLAYED</strong>
<form>
      <fieldset>
        <legend>League of Legends</legend>
        <label for="inputName"></label> Summoner Name: 
        <input type="text" name="inputName" id="inputName">
        <input type="submit" id="urlSubmit">
      </fieldset>
    </form>
    <div>
      <h2> League of Legends</h2>
      <ul>
        <li><span>Summoner ID: </span><span id="sumid"></span></li>
		<li><span>Summoner Level: </span><span id="sumlvl"></span></li>
		<li><span>Lane: </span><span id="lane"></span></li>
		<li><span>Champion: </span><span id="champ"></span></li>
		<li><span>Last Match: </span><span id="win"></span></li>

      </ul>
    </div>
<p>
    In conclusion, I hope that this little shows you how much information the
    API lets you get just from a single data input, in this case summoner name.
    With a series of GET calls, you can let the api retrieve almost anything
    about the summoner. If you want a challenge, you can instead go into the
    stats of the match and using the static data/item, find and list the items
    used by the player, or their gold or minion kills. The ability to use API’s
    to display and access information on a autonomous level is a very welcome
    addition to programming. I hope my How To guide helped show you how to
    craft a program like this.
</p>

  </body>
</html>
